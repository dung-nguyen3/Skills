# EXCEL COMPARISON CHART TEMPLATE
# For ANY medical topic comparisons (conditions, mechanisms, concepts)

## CRITICAL REQUIREMENTS

1. **Source-Only Policy**: Only use information from the source file. Do not add external medical knowledge.
2. **3-Tab Structure**: Key Comparisons, Master Chart, Summary (in that order)
   - **Note**: This comparison chart's 3-tab structure with Summary tab includes "If X Think Y" associations, critical values, key definitions, and high-yield exam pearls.

---

## COLOR RULES (CRITICAL - READ CAREFULLY)

**See:** `Excel_Color_Reference.txt` for complete color palette with HEADER and MAIN shades.

**Core Principle:** Same category = same color. Change color only when category changes.

### Two-Shade System (HEADER vs MAIN)
Each color has TWO shades:
- **HEADER shade** (25% darker) = Table title rows, column headers
- **MAIN shade** (lighter) = Data rows

```
Example using Ice Blue:
- Table Title Row: #B4C6E7 (HEADER - darker)
- Column Headers: #B4C6E7 (HEADER - darker)
- Data Rows: #D9E2F3 (MAIN - lighter)
```

### Tab 1: Key Comparisons
- Each comparison TABLE gets ONE color SET (both HEADER and MAIN shades)
- Table title row and column headers = HEADER shade (25% darker)
- Data rows = MAIN shade (lighter)
- Change color SET when starting a NEW table

**Example:**
| Table | Content | Title/Headers | Data Rows |
|-------|---------|---------------|-----------|
| Table 1 | Mechanism comparison | #B4C6E7 (Ice Blue HEADER) | #D9E2F3 (Ice Blue MAIN) |
| Table 2 | Clinical comparison | #A8CCA8 (Seafoam HEADER) | #C8E6C9 (Seafoam MAIN) |
| Table 3 | Treatment comparison | #B8A4D0 (Light Orchid HEADER) | #D1C4E9 (Light Orchid MAIN) |

### Tab 2: Master Chart
**NOTE:** Master Chart does NOT use the two-shade system. It uses:
- Header row = Dark blue #4472C4 with white text, size 12
- Data rows = MAIN pastel colors only, size 10
- All items in same CATEGORY/CLASS = same MAIN color
- Change color when category/class changes

**Example (Drug Chart):**
| Row Type | Drug | Class | Color |
|----------|------|-------|-------|
| Header Row | - | - | #4472C4 (Dark Blue, white text) |
| Data Row | Metoprolol | Beta Blocker | #D9E2F3 (Ice Blue MAIN) |
| Data Row | Atenolol | Beta Blocker | #D9E2F3 (Ice Blue MAIN) |
| Data Row | Lisinopril | ACE Inhibitor | #C8E6C9 (Seafoam MAIN) |
| Data Row | Enalapril | ACE Inhibitor | #C8E6C9 (Seafoam MAIN) |

**Example (Condition Chart):**
| Row Type | Condition | Category | Color |
|----------|-----------|----------|-------|
| Header Row | - | - | #4472C4 (Dark Blue, white text) |
| Data Row | Type I Hypersensitivity | Hypersensitivity | #D9E2F3 (Ice Blue MAIN) |
| Data Row | Type II Hypersensitivity | Hypersensitivity | #D9E2F3 (Ice Blue MAIN) |
| Data Row | Type III Hypersensitivity | Hypersensitivity | #D9E2F3 (Ice Blue MAIN) |
| Data Row | Type IV Hypersensitivity | Hypersensitivity | #D9E2F3 (Ice Blue MAIN) |

### Tab 3: Summary
- Sheet title only: Dark blue (#4472C4) with white text
- Section headers within sheet: Use HEADER shade of that section's color
- Clinical pearl boxes: Light green (#E8F5E9)
- Other content: Rotate pastels by section type

### WRONG vs RIGHT

**WRONG:** Alternating row colors within one table/category
**RIGHT:** One solid color for entire table/category

### Text Formatting Within Cells:
- Use bullet points (•) for lists
- Use line breaks (\n) for readability
- Bold critical warnings (but keep black color)

---

## FORMATTING REQUIREMENTS - Python Reference

**→ See Excel_Comparison_Example.py for exact implementation of all formatting requirements**

### Colors
- 3-shade COLOR_SETS system (header, main, row_label)
- Rotate by category using pastel palette
- All data cells MUST have pastel backgrounds

**→ See Excel_Comparison_Example.py lines 25-95 for exact COLOR_SETS and rotation logic**

### Borders
- White thin borders on ALL cells
- Apply to ALL cells BEFORE merging (see merged cell section below)

**→ See Excel_Comparison_Example.py for border definitions**

### Row Heights & Column Widths
- Vary by content type and tab

**→ See Excel_Comparison_Example.py for exact dimensions per element**

### CRITICAL: Merged Cell Border Behavior

When merging cells in openpyxl, only the top-left cell retains styling (borders, colors, etc.). Other cells become MergedCell objects and lose formatting.

**CORRECT PATTERN (always use):**
1. Apply styling (borders, colors, fonts) to ALL cells in range FIRST
2. THEN merge the cells

**Example:**
```python
# Step 1: Style ALL cells in the range
for col_idx in range(start_col, end_col + 1):
    cell = ws.cell(current_row, col_idx)
    apply_cell_style(cell, text=value if col_idx==start_col else '', bg_color=color)

# Step 2: THEN merge
ws.merge_cells(start_row=current_row, start_column=start_col,
               end_row=current_row, end_column=end_col)
```

**→ See Excel_Comparison_Example.py lines 136-143 and 189-195 for complete implementation**
- UPPERCASE for emphasis (FATAL, NEVER, etc.)

---

## OBJECTIVE

Create comprehensive medical comparison Excel files with:
1. **Key Comparison Sheet** - Multiple side-by-side comparison tables (one category per table)
2. **Master Chart Sheet** - Comprehensive overview of all topics in one table
3. **Summary Sheet** - Mnemonics, "If X Think Y", critical values, high-yield pearls

---

## CRITICAL: DYNAMIC TABLE COUNT

The number of comparison tables is NOT fixed. Create as many tables as needed to compare the information asked in the learning objectives.

### How to Determine Tables:

1. **Analyze source learning objectives** - identify ALL comparison categories:
   - Clinical Presentation
   - Pathophysiology/Mechanism
   - Diagnosis/Labs
   - Treatment
   - Prognosis
   - Complications
   - Risk Factors
   - Epidemiology
   - [Any other categories asked in LOs]

2. **Create ONE table per category** - each table compares that category across all items
   - Each table compares 1-2 categories at a time to help break it down and differentiate

3. **Example**: If comparing Clinical Presentation, Diagnosis, and Treatment for Conditions A, B, C:
   - Table 1: Clinical Presentation comparing Conditions A, B, and C
   - Table 2: Diagnosis comparing Conditions A, B, and C
   - Table 3: Treatment comparing Conditions A, B, and C

4. **If source has 6 comparison categories across 4 conditions:**
   - Create 6 separate comparison tables
   - NOT 3 tables with categories combined

**WRONG**: 3 tables combining multiple categories
**RIGHT**: N tables where N = number of comparison categories in learning objectives

---

## TAB 1: KEY COMPARISONS

### Purpose
Compare similar items side-by-side (e.g., Type I vs Type II vs Type III vs Type IV hypersensitivity)

### Structure
- **COLUMNS** = Items being compared (e.g., Type I, Type II, Type III, Type IV)
- **ROWS** = Comparison categories (e.g., Mechanism, Mediators, Examples, Treatment)

### Layout Rules
```
Row 1: [COMPARISON TITLE - merged across all columns]
Row 2: [Column headers - items being compared]
Row 3+: [Comparison category rows]
[blank row]
[MNEMONIC row - if applicable]
[2-3 blank rows before next comparison table]
```

### Critical Rules
1. **One comparison per table** - Don't mix different comparisons in one table
2. **Multiple tables** - Create separate tables for each category being compared
   - Example: If comparing Clinical Presentation, Diagnosis, and Treatment for Conditions A, B, C:
     - Table 1: Compare Clinical Presentation across A, B, C
     - Table 2: Compare Diagnosis across A, B, C
     - Table 3: Compare Treatment across A, B, C
3. **Mnemonics directly below** - Place relevant mnemonic immediately after each table
4. **Consistent categories** - Use same rows for all compared items within a table
5. **Column width**: Column A = 25, others = 35-40
6. **Text wrapping**: Enable for all cells

### Comparison Focus Areas
When creating comparisons, prioritize:
1. Items students frequently confuse
2. Actionable clinical decisions (not just theory)
3. SPECIFIC treatments with EXACT dosing (never vague)
4. Treatment-focused tables (what to prescribe in each scenario)
5. Age-based and severity-based algorithms
6. Hallmark/pathognomonic findings
7. "If-then" clinical decision rules
8. Urgency levels for referrals/complications

---

## TAB 2: MASTER CHART

### Purpose
Comprehensive overview of ALL conditions/concepts in one searchable table

### Structure
- **ROWS** = Individual conditions/topics (one per row)
- **COLUMNS** = Key characteristics

### Standard Columns (adapt based on content)
- Condition/Disease/Concept
- Definition
- Etiology/Causes
- Clinical Presentation/Symptoms
- Pathophysiology/Mechanism
- Diagnosis/Labs
- Treatment (First-line)
- Treatment (Alternatives)
- Complications
- Key Differentiators

### Layout Rules
```
Row 1: [Column Headers - frozen]
Row 2+: [One condition per row]
```

### Critical Rules
1. **Freeze first row** - Always freeze header row
2. **Text wrapping** - Enable for all cells
3. **Color coding** - Rotate pastel colors by category/group
4. **Column widths**:
   - Column A (Condition): 25
   - Other columns: 30-40

---

## TAB 3: SUMMARY

### Purpose
Quick-reference high-yield information for rapid review

### Required Sections (for Clinical Medicine Sources)

The Summary sheet should include the following sections:

#### 1. "If You See X, Think Y" Associations
```
If you see [finding/symptom] → Think [diagnosis/condition]
```

#### 2. Critical Values
```
[Parameter]: [Critical threshold] → [Action required]
```

#### 3. Key Definitions
```
[Term]: [Definition from source]
```

#### 4. Final High-Yield Exam Pearls
- Board-relevant facts
- Clinical decision points
- Must-know associations
- Key exam takeaways

### Formatting Rules
- Blue bold label for section headers (color='0000FF')
- Text wrapping enabled
- Adequate row heights (60-100 for multiline content)

---

## PYTHON IMPLEMENTATION NOTES

### Required Imports
```python
from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill, Alignment, Border, Side
from openpyxl.utils import get_column_letter
```

### Key Functions to Implement
1. `apply_cell_style()` - Universal cell formatting
2. `create_header_row()` - Formatted header with freeze
3. `set_column_widths()` - Appropriate widths per tab

### Tab Creation Order
1. Create "Key Comparisons" tab first (set as active)
2. Create "Master Chart" tab
3. Create "Summary" tab
4. Remove default empty sheet if created

---

## SAVE LOCATION

Save to: `[Class]/[Exam]/Claude Study Tools/[Topic]_Comparison_Chart.xlsx`

Example: `Clinical Medicine/Exam 2/Claude Study Tools/Hypersensitivity_Comparison_Chart.xlsx`

---

## FINAL CHECKLIST

### Content Verification
- [ ] All information from source files is included
- [ ] No external information added
- [ ] Medical terminology matches source exactly
- [ ] All learning objectives are addressed

### Tab 1: Key Comparisons
- [ ] Multiple comparison tables (not one giant table)
- [ ] One category per table
- [ ] Clear column headers (items being compared)
- [ ] Adequate spacing between tables (2-3 blank rows)

### Tab 2: Master Chart
- [ ] One row per condition/topic
- [ ] All relevant columns included
- [ ] First row frozen
- [ ] Text wrapping enabled
- [ ] Color-coded by category

### Tab 3: Summary
- [ ] "If X Think Y" associations
- [ ] Critical values (if applicable)
- [ ] Key definitions
- [ ] High-yield pearls

### Formatting
- [ ] Column widths set appropriately (25-45)
- [ ] Row heights adjusted for wrapped text
- [ ] Consistent fonts and colors
- [ ] Each comparison table uses ONE consistent color (not alternating rows)
- [ ] Master Chart: same category/class = same color
- [ ] No formula errors
- [ ] File saved to correct location

---

## EXAMPLE OUTPUT STRUCTURE

```
Sheet 1: Key Comparisons
├── Comparison Table 1: Clinical Presentation (rows 1-10)
├── [blank rows 11-12]
├── Comparison Table 2: Diagnosis (rows 13-22)
├── [blank rows 23-24]
├── Comparison Table 3: Treatment (rows 25-34)
└── ...

Sheet 2: Master Chart
├── Header Row (row 1) ← Frozen
├── Condition 1 (row 2)
├── Condition 2 (row 3)
├── ...
└── Condition N (row N)

Sheet 3: Summary
├── IF X THINK Y section
├── CRITICAL VALUES section
├── KEY DEFINITIONS section
└── HIGH-YIELD PEARLS section
```
