# EXCEL COMPARISON CHART TEMPLATE
# For ANY medical topic comparisons (conditions, mechanisms, concepts)

## CRITICAL REQUIREMENTS

1. **Source-Only Policy**: Only use information from the source file. Do not add external medical knowledge.
2. **3-Tab Structure**: Key Comparisons, Master Chart, Summary (in that order)
   - **Note**: This comparison chart's 3-tab structure with Summary tab includes "If X Think Y" associations, critical values, key definitions, and high-yield exam pearls.

---

## COLOR RULES (CRITICAL - READ CAREFULLY)

**See:** `Excel_Color_Reference.txt` for complete color palette with HEADER and MAIN shades.

**Core Principle:** Same category = same color. Change color only when category changes.

### Two-Shade System (HEADER vs MAIN)
Each color has TWO shades:
- **HEADER shade** (25% darker) = Table title rows, column headers
- **MAIN shade** (lighter) = Data rows

```
Example using Ice Blue:
- Table Title Row: #B4C6E7 (HEADER - darker)
- Column Headers: #B4C6E7 (HEADER - darker)
- Data Rows: #D9E2F3 (MAIN - lighter)
```

### Tab 1: Key Comparisons
- Each comparison TABLE gets ONE color SET (both HEADER and MAIN shades)
- Table title row and column headers = HEADER shade (25% darker)
- Data rows = MAIN shade (lighter)
- Change color SET when starting a NEW table

**Example:**
| Table | Content | Title/Headers | Data Rows |
|-------|---------|---------------|-----------|
| Table 1 | Mechanism comparison | #B4C6E7 (Ice Blue HEADER) | #D9E2F3 (Ice Blue MAIN) |
| Table 2 | Clinical comparison | #A8CCA8 (Seafoam HEADER) | #C8E6C9 (Seafoam MAIN) |
| Table 3 | Treatment comparison | #B8A4D0 (Light Orchid HEADER) | #D1C4E9 (Light Orchid MAIN) |

### Tab 2: Master Chart
**NOTE:** Master Chart does NOT use the two-shade system. It uses:
- Header row = Dark blue #4472C4 with white text, size 12
- Data rows = MAIN pastel colors only, size 10
- All items in same CATEGORY/CLASS = same MAIN color
- Change color when category/class changes

**Example (Drug Chart):**
| Row Type | Drug | Class | Color |
|----------|------|-------|-------|
| Header Row | - | - | #4472C4 (Dark Blue, white text) |
| Data Row | Metoprolol | Beta Blocker | #D9E2F3 (Ice Blue MAIN) |
| Data Row | Atenolol | Beta Blocker | #D9E2F3 (Ice Blue MAIN) |
| Data Row | Lisinopril | ACE Inhibitor | #C8E6C9 (Seafoam MAIN) |
| Data Row | Enalapril | ACE Inhibitor | #C8E6C9 (Seafoam MAIN) |

**Example (Condition Chart):**
| Row Type | Condition | Category | Color |
|----------|-----------|----------|-------|
| Header Row | - | - | #4472C4 (Dark Blue, white text) |
| Data Row | Type I Hypersensitivity | Hypersensitivity | #D9E2F3 (Ice Blue MAIN) |
| Data Row | Type II Hypersensitivity | Hypersensitivity | #D9E2F3 (Ice Blue MAIN) |
| Data Row | Type III Hypersensitivity | Hypersensitivity | #D9E2F3 (Ice Blue MAIN) |
| Data Row | Type IV Hypersensitivity | Hypersensitivity | #D9E2F3 (Ice Blue MAIN) |

### Tab 3: Summary
- Sheet title only: Dark blue (#4472C4) with white text
- Section headers within sheet: Use HEADER shade of that section's color
- Clinical pearl boxes: Light green (#E8F5E9)
- Other content: Rotate pastels by section type

### WRONG vs RIGHT

**WRONG:** Alternating row colors within one table/category
**RIGHT:** One solid color for entire table/category

### Text Formatting Within Cells:
- Use bullet points (•) for lists
- Use line breaks (\n) for readability
- Bold critical warnings (but keep black color)

---

## FORMATTING REQUIREMENTS - Python Reference

**→ See Excel_Comparison_Example.py for exact implementation of all formatting requirements**

### Colors
- 3-shade COLOR_SETS system (header, main, row_label)
- Rotate by category using pastel palette
- All data cells MUST have pastel backgrounds

**→ See Excel_Comparison_Example.py lines 25-95 for exact COLOR_SETS and rotation logic**

### Borders
- White thin borders on ALL cells
- Apply to ALL cells BEFORE merging (see merged cell section below)

**→ See Excel_Comparison_Example.py for border definitions**

### Row Heights & Column Widths
- Vary by content type and tab

**→ See Excel_Comparison_Example.py for exact dimensions per element**

### CRITICAL: Merged Cell Border Behavior

When merging cells in openpyxl, only the top-left cell retains styling (borders, colors, etc.). Other cells become MergedCell objects and lose formatting.

**CORRECT PATTERN (always use):**
1. Apply styling (borders, colors, fonts) to ALL cells in range FIRST
2. THEN merge the cells

**Example:**
```python
# Step 1: Style ALL cells in the range
for col_idx in range(start_col, end_col + 1):
    cell = ws.cell(current_row, col_idx)
    apply_cell_style(cell, text=value if col_idx==start_col else '', bg_color=color)

# Step 2: THEN merge
ws.merge_cells(start_row=current_row, start_column=start_col,
               end_row=current_row, end_column=end_col)
```

**→ See Excel_Comparison_Example.py lines 136-143 and 189-195 for complete implementation**
- UPPERCASE for emphasis (FATAL, NEVER, etc.)

---

## OBJECTIVE

Create comprehensive medical comparison Excel files with:
1. **Key Comparison Sheet** - Multiple side-by-side comparison tables (one category per table)
2. **Master Chart Sheet** - Comprehensive overview of all topics in one table
3. **Summary Sheet** - Mnemonics, "If X Think Y", critical values, high-yield pearls

---

## CRITICAL: DYNAMIC TABLE COUNT

The number of comparison tables is NOT fixed. Create as many tables as needed to comprehensively compare the information in the source file.

### How to Determine Tables:

<category_selection_protocol>

**Step 1: Analyze Source Content**
Read the entire source file to identify:
- Main topics being covered
- Items that need comparison (similar types/categories that appear together)
- Content found in "Lecture Outline", "Outline", or "Overview" sections
- Subtypes within major categories

**Step 2: Select Relevant Categories from Menus**
Choose categories from the menus below or other shared categories mentioned in source file that enable meaningful comparisons. Create comparison tables for categories that:
- Help differentiate similar items
- Enable clinical decision-making
- Contain critical distinguishing features
- Are explicitly mentioned in the source as important comparisons

**Step 3: Create ONE Table Per Category**
Each table compares that single category across all items (don't combine categories).

**Content Selection Filter - Include if:**
- Category helps differentiate items that are similar/easily confused
- Category enables actionable clinical decisions
- Category contains hallmark/pathognomonic/distinguishing findings
- Category is emphasized or repeated throughout the source
- Items within category share meaningful comparable characteristics

**Content Selection Filter - Exclude if:**
- Tangential information not central to the topic
- Only one item has data for this category (no comparison possible)
- Category is mentioned briefly without detail

</category_selection_protocol>

---

### COMPREHENSIVE CATEGORY MENUS

<menu id="A" topic="Diagnostic Tools & Tests">
**When to use:** Comparing diagnostic modalities, imaging studies, laboratory tests

**Categories:**
- Test Type & Modality (imaging, lab, physical exam finding)
- Test Subtype if applicable
- Test Characteristics (Sensitivity, Specificity, PPV, NPV, Accuracy)
- Indications (When to Order / Clinical Scenarios)
- Uses
- Evaluates
- Contraindications & Limitations
- Interpretation (How to Read Results / What Results Mean)
- Cost & Availability
- Procedure Details & Patient Preparation
- Advantages & Disadvantages
- Comparison to Alternative Tests
- Follow-up Based on Results


**Example:** Comparing D-dimer, CT angiography, V/Q scan for PE diagnosis
**Example:** Comparing different types of ECG and uses
</menu>

<menu id="B" topic="Medical Conditions (Universal - Any Specialty)">
**When to use:** Comparing diseases, disorders, syndromes across ANY medical specialty

**Categories:**
- Clinical Presentation (Signs & Symptoms / How Patients Present)
- Pathophysiology/Mechanism (How/Why It Happens)
- Etiology & Risk Factors (What Causes It / Who Gets It)
- Epidemiology (Demographics, Prevalence, Incidence)
- Diagnosis & Workup (How to Diagnose / Tests to Order)
- Differential Diagnosis (What Else Could It Be)
- Treatment & Management (First-line, Second-line, Specific Regimens)
- Prognosis & Natural History
- Complications & Adverse Outcomes
- Prevention & Screening
- Anatomic Location/Distribution (Where It Affects)
- Characteristic Physical/Structural Changes
- Systemic/Extra-primary-site Manifestations
- Disease Severity Classification
- Time Course/Onset Pattern (Acute, Subacute, Chronic)
- Triggers & Exacerbating Factors
- Key Differentiators (Hallmark/Pathognomonic Findings)

**Example:** Comparing Type I, II, III, IV hypersensitivity reactions
**Example:** Comparing systemic lupus erythematosus, rheumatoid arthritis, scleroderma
**Example:** Comparing acute coronary syndrome types (STEMI, NSTEMI, unstable angina)
</menu>

<menu id="C" topic="Pharmacology (Drugs & Drug Classes)">
**When to use:** Comparing medications, drug classes, therapeutic agents

**Categories:**
- Mechanism of Action (How Drug Works)
- Indications (What It Treats / When to Prescribe)
- Contraindications (When NOT to Use)
- Dosing & Administration (Route, Frequency, Duration)
- Pharmacokinetics (Absorption, Distribution, Metabolism, Excretion)
- Adverse Effects & Toxicity (Side Effects, Black Box Warnings)
- Drug Interactions
- Monitoring Requirements (Labs, Vitals)
- Special Populations (Pregnancy, Pediatrics, Geriatrics, Renal/Hepatic)
- Efficacy & Clinical Outcomes
- Cost & Accessibility
- Advantages Over Alternatives
- Key Differentiators (Unique Properties)

**Example:** Comparing beta blockers (metoprolol, atenolol, carvedilol)
</menu>

<menu id="D" topic="Pathophysiologic Mechanisms">
**When to use:** Comparing underlying biological processes, molecular pathways

**Categories:**
- Cellular/Molecular Mechanism
- Affected Organs/Systems
- Pathway Components (Enzymes, Receptors, Mediators)
- Triggers & Initiating Factors
- Progression & Cascade of Events
- Regulatory Mechanisms
- End-Organ Effects
- Compensation Mechanisms
- Clinical Manifestations from Mechanism
- Therapeutic Targets in Pathway

**Example:** Comparing different shock types (hypovolemic, cardiogenic, distributive)
</menu>

<menu id="E" topic="Clinical Assessment Components">
**When to use:** Comparing history-taking elements, physical exam techniques

**Categories:**
- Specific History Questions (What to Ask)
- Physical Exam Maneuvers (What to Do / How to Perform)
- Expected Findings (Normal vs Abnormal)
- Interpretation (What Findings Mean)
- Sensitivity & Specificity of Exam Finding
- Special Techniques & Variations
- Patient Positioning & Preparation
- Age-Specific Considerations
- Documentation Standards

**Example:** Comparing orthopedic special tests (McMurray, Lachman, drawer test)
</menu>

<menu id="F" topic="Treatment Modalities & Interventions">
**When to use:** Comparing therapeutic approaches, procedures, interventions

**Categories:**
- Treatment Type (Medical, Surgical, Procedural, Supportive)
- Indications (When to Use This Treatment)
- Contraindications (When NOT to Use)
- Procedure/Protocol Details (How It's Done)
- Expected Outcomes & Efficacy
- Adverse Effects & Complications
- Recovery/Follow-up Requirements
- Alternatives & When to Choose Each
- Patient Selection Criteria
- Evidence Base & Guidelines
- Cost & Resource Requirements
- Age/Severity-Based Algorithms

**Example:** Comparing treatment approaches for heart failure (ACEi, ARB, beta blocker, diuretics)
</menu>

<menu id="G" topic="Risk Factors & Protective Factors">
**When to use:** Comparing what increases or decreases disease risk

**Categories:**
- Modifiable Risk Factors (Can Be Changed)
- Non-Modifiable Risk Factors (Cannot Be Changed)
- Protective Factors (Reduce Risk)
- Relative Risk/Odds Ratio (How Much Risk)
- Mechanism of Risk (Why It Increases Risk)
- Population at Highest Risk
- Prevention Strategies Targeting This Risk
- Risk Assessment Tools/Scores

**Example:** Comparing cardiovascular risk factors
</menu>

<menu id="H" topic="Disease Classifications & Staging">
**When to use:** Comparing classification systems, staging criteria

**Categories:**
- Classification Criteria (What Defines Each Type/Stage)
- Clinical Significance (Why Classification Matters)
- Prognosis by Stage/Type
- Treatment Differences by Stage/Type
- Progression Between Stages
- Assessment Tools for Staging
- Nomenclature & Terminology

**Example:** Comparing chronic kidney disease stages (CKD 1-5)
</menu>

<menu id="I" topic="Laboratory Values & Biomarkers">
**When to use:** Comparing lab tests, biomarkers, clinical measurements

**Categories:**
- Normal Reference Ranges (What's Normal)
- Abnormal Values & Interpretation (High vs Low Meaning)
- Clinical Significance (When to Worry)
- Conditions Associated with Abnormality
- Timing of Measurement (When to Check)
- Interfering Factors (What Affects Results)
- Sensitivity & Specificity for Diagnosis
- Monitoring Frequency
- Critical Values & Actions

**Example:** Comparing cardiac biomarkers (troponin, CK-MB, BNP)
</menu>

<menu id="J" topic="Anatomic Structures & Systems">
**When to use:** Comparing anatomical regions, organs, systems

**Categories:**
- Location & Boundaries
- Structure & Composition
- Function & Physiology
- Innervation & Vascular Supply
- Anatomic Relationships (Adjacent Structures)
- Clinical Relevance
- Common Pathologies Affecting This Structure
- Physical Exam Correlation

**Example:** Comparing heart valves (mitral, tricuspid, aortic, pulmonic)
</menu>

<menu id="K" topic="Procedures & Diagnostic Techniques">
**When to use:** Comparing clinical procedures, surgical techniques

**Categories:**
- Procedure Type & Approach
- Indications (When to Perform)
- Contraindications (When NOT to Perform)
- Patient Preparation & Consent
- Equipment & Setup
- Step-by-Step Technique
- Expected Findings/Results
- Complications
- Management
- Post-Procedure Care
- Alternatives & When to Choose
- Patient Education
- Considerations


**Example:** Comparing joint aspiration techniques for different joints
</menu>

<menu id="L" topic="Differential Diagnosis & Clinical Reasoning">
**When to use:** Comparing possible diagnoses for a presentation

**Categories:**
- Key Distinguishing Features (What Sets It Apart)
- Clinical Presentation Overlap (Similarities)
- Diagnostic Tests to Differentiate
- Urgency/Severity Considerations
- Likelihood/Prevalence in This Population
- "Red Flags" for Each Diagnosis
- Initial Workup Approach
- Decision Rules/Algorithms

**Example:** Comparing causes of chest pain (ACS, PE, aortic dissection, pneumonia)
</menu>

<menu id="M" topic="Systems & Physiologic Functions">
**When to use:** Comparing body systems, physiologic processes, homeostatic mechanisms

**Categories:**
- Primary Function (What System Does)
- Key Components (Organs, Cells, Molecules Involved)
- Regulation & Control Mechanisms
- Integration with Other Systems
- Normal Physiology Parameters
- Pathophysiology When Disrupted
- Clinical Assessment of Function
- Age-Related Changes

**Example:** Comparing sympathetic vs parasympathetic nervous system
</menu>

**Other Categories**
- Include any other shared categories not listed above if mentioned in source file.
---

### How to Use These Menus

**Example 1: Diagnostic Tools**
Source topic: "Diagnostic tests for pulmonary embolism"
- Use Menu A (Diagnostic Tools)
- Select relevant categories: Test Characteristics, Indications, Interpretation, Advantages/Disadvantages
- Create 4 separate comparison tables (one per category)

**Example 2: Medical Conditions**
Source topic: "Hypersensitivity reactions"
- Use Menu B (Medical Conditions)
- Select relevant categories: Pathophysiology/Mechanism, Clinical Presentation, Treatment
- Create 3 separate comparison tables

**Example 3: Mixed Topic**
Source topic: "Pathophysiology of shock types and their management"
- Use Menu D (Pathophysiologic Mechanisms) for mechanism comparison
- Use Menu F (Treatment Modalities) for management comparison
- Create tables from both menus as needed

---

### Critical Rules

**WRONG**: 3 tables combining multiple categories (e.g., one table with mechanism AND treatment AND diagnosis)
**RIGHT**: N tables where N = number of relevant categories from menus (one category per table)

**WRONG**: Creating comparison tables for all categories in a menu regardless of source content
**RIGHT**: Only create tables for categories with meaningful comparable data in the source

---

## TAB 1: KEY COMPARISONS

### Purpose
Compare similar items side-by-side (e.g., Type I vs Type II vs Type III vs Type IV hypersensitivity)

### Structure
- **COLUMNS** = Items being compared (e.g., Type I, Type II, Type III, Type IV)
- **ROWS** = Comparison categories (e.g., Mechanism, Mediators, Examples, Treatment)

### Layout Rules
```
Row 1: [COMPARISON TITLE - merged across all columns]
Row 2: [Column headers - items being compared]
Row 3+: [Comparison category rows]
[blank row]
[MNEMONIC row - if applicable]
[2-3 blank rows before next comparison table]
```

### Critical Rules
1. **One comparison per table** - Don't mix different comparisons in one table
2. **Multiple tables** - Create separate tables for each category being compared
   - Example: If comparing Clinical Presentation, Diagnosis, and Treatment for Conditions A, B, C:
     - Table 1: Compare Clinical Presentation across A, B, C
     - Table 2: Compare Diagnosis across A, B, C
     - Table 3: Compare Treatment across A, B, C
3. **Mnemonics directly below** - Place relevant mnemonic immediately after each table
4. **Consistent categories** - Use same rows for all compared items within a table
5. **Column width**: Column A = 25, others = 35-40
6. **Text wrapping**: Enable for all cells

### Comparison Focus Areas
When creating comparisons, prioritize:
1. Items students frequently confuse
2. Actionable clinical decisions (not just theory)
3. SPECIFIC treatments with EXACT dosing (never vague)
4. Treatment-focused tables (what to prescribe in each scenario)
5. Age-based and severity-based algorithms
6. Hallmark/pathognomonic findings
7. "If-then" clinical decision rules
8. Urgency levels for referrals/complications
9. Other high yield exam information

---

## TAB 2: MASTER CHART

### Purpose
Comprehensive overview of ALL conditions/concepts in one searchable table

### Structure
- **ROWS** = Individual conditions/topics (one per row)
- **COLUMNS** = Key characteristics

### Standard Columns (adapt based on content)
- Condition/Disease/Concept
- Definition
- Etiology/Causes
- Clinical Presentation/Symptoms
- Pathophysiology/Mechanism
- Diagnosis/Labs
- Treatment (First-line)
- Treatment (Alternatives)
- Complications
- Key Differentiators

### Example Column Categories by Topic Type

**For Diagnostic Tools/Tests:**
- Test Name
- Category/Type
- Technology/How It Works
- Indications
- Contraindications
- Protocol/Procedure
- Interpretation
- Key Characteristics

**For Procedures:**
- Procedure Name
- Procedure Type & Approach
- Indications
- Contraindications
- Patient Preparation & Consent
- Equipment & Setup
- Step-by-Step Technique
- Expected Findings/Results
- Complications
- Management
- Post-Procedure Care
- Alternatives & When to Choose
- Patient Education
- Considerations

**For Medical Conditions:**
- Condition/Disease
- Definition
- Etiology/Causes
- Clinical Presentation/Symptoms
- Pathophysiology/Mechanism
- Diagnosis/Labs
- Treatment (First-line)
- Treatment (Alternatives)
- Complications
- Key Differentiators

**For Drugs:**
- Drug Name
- Drug Class
- Mechanism of Action
- Indications
- Contraindications
- Dosing
- Adverse Effects
- Drug Interactions
- Monitoring
- Special Populations

**IMPORTANT:** These are EXAMPLES only. Adapt columns based on what categories are actually mentioned and shared throughout the source file. Use source-driven column selection.

**Column Selection Guidelines:**
- Review what information is provided for each item in the source
- Identify categories that appear consistently across multiple items
- Include columns for categories that enable meaningful comparison
- Exclude categories where only 1-2 items have data
- Add source-specific columns not listed in examples if they appear frequently

### Layout Rules
```
Row 1: [Column Headers - frozen]
Row 2+: [One condition per row]
```

### Critical Rules
1. **Freeze first row** - Always freeze header row
2. **Text wrapping** - Enable for all cells
3. **Color coding** - Rotate pastel colors by category/group
4. **Column widths**:
   - Column A (Condition): 25
   - Other columns: 30-40

---

## TAB 3: SUMMARY

### Purpose
Quick-reference high-yield information for rapid review

### Required Sections (for Clinical Medicine Sources)

The Summary sheet should include the following sections:

#### 1. "If You See X, Think Y" Associations
```
If you see [finding/symptom] → Think [diagnosis/condition]
```

#### 2. Critical Values
```
[Parameter]: [Critical threshold] → [Action required]
```

#### 3. Key Definitions
```
[Term]: [Definition from source]
```

#### 4. Final High-Yield Exam Pearls
- Board-relevant facts
- Clinical decision points
- Must-know associations
- Key exam takeaways

### Formatting Rules
- Blue bold label for section headers (color='0000FF')
- Text wrapping enabled
- Adequate row heights (60-100 for multiline content)

---

## PYTHON IMPLEMENTATION NOTES

### Required Imports
```python
from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill, Alignment, Border, Side
from openpyxl.utils import get_column_letter
```

### Key Functions to Implement
1. `apply_cell_style()` - Universal cell formatting
2. `create_header_row()` - Formatted header with freeze
3. `set_column_widths()` - Appropriate widths per tab

### Tab Creation Order
1. Create "Key Comparisons" tab first (set as active)
2. Create "Master Chart" tab
3. Create "Summary" tab
4. Remove default empty sheet if created

---

## SAVE LOCATION

Save to: `[Class]/[Exam]/Claude Study Tools/[Topic]_Comparison_Chart.xlsx`

Example: `Clinical Medicine/Exam 2/Claude Study Tools/Hypersensitivity_Comparison_Chart.xlsx`

---

## FINAL CHECKLIST

### Content Verification
- [ ] All information from source files is included
- [ ] No external information added
- [ ] Medical terminology matches source exactly
- [ ] All major topics and comparable content from source are included

### Tab 1: Key Comparisons
- [ ] Multiple comparison tables (not one giant table)
- [ ] One category per table
- [ ] Clear column headers (items being compared)
- [ ] Adequate spacing between tables (2-3 blank rows)

### Tab 2: Master Chart
- [ ] One row per condition/topic
- [ ] All relevant columns included
- [ ] First row frozen
- [ ] Text wrapping enabled
- [ ] Color-coded by category

### Tab 3: Summary
- [ ] "If X Think Y" associations
- [ ] Critical values (if applicable)
- [ ] Key definitions
- [ ] High-yield pearls

### Formatting
- [ ] Column widths set appropriately (25-45)
- [ ] Row heights adjusted for wrapped text
- [ ] Consistent fonts and colors
- [ ] Each comparison table uses ONE consistent color (not alternating rows)
- [ ] Master Chart: same category/class = same color
- [ ] No formula errors
- [ ] File saved to correct location

---

## EXAMPLE OUTPUT STRUCTURE

```
Sheet 1: Key Comparisons
├── Comparison Table 1: Clinical Presentation (rows 1-10)
├── [blank rows 11-12]
├── Comparison Table 2: Diagnosis (rows 13-22)
├── [blank rows 23-24]
├── Comparison Table 3: Treatment (rows 25-34)
└── ...

Sheet 2: Master Chart
├── Header Row (row 1) ← Frozen
├── Condition 1 (row 2)
├── Condition 2 (row 3)
├── ...
└── Condition N (row N)

Sheet 3: Summary
├── IF X THINK Y section
├── CRITICAL VALUES section
├── KEY DEFINITIONS section
└── HIGH-YIELD PEARLS section
```
