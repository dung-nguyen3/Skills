# Excel Drug Chart Template - Instructions

## Purpose
Create comprehensive, color-coded 3-tab Excel drug charts from pharmacology source material.

---

## Core Requirements

**See parent CLAUDE.md for:**
- Source-only policy (use ONLY source file information)
- Verification checklists
- File organization

**Excel-specific requirements:**
- 3 tabs: Drug Details, Key Comparisons, Master Chart
- Soft pastel color scheme (see Excel_Color_Reference.txt)
- Include page references in cells for verification

---

## Reference Files

**Color scheme & formatting:**
- `Excel_Color_Reference.txt` - Complete color palette and styling specs

**Complete working example:**
- `Python_Examples/Excel_Drug_Example.py` - Full 3-tab implementation with all code

---

## FILE STRUCTURE: 3 TABS (+ Optional FYI Tab)

### Tab 1: Drug Details
- Sheet name: "Drug Details"
- Drug class comparison tables
- Each drug class = its own table with drugs as columns
- Merged cells for properties shared across ALL drugs in class
- Color-coded by drug class (rotate through color palette)

**Row Order (10 categories):**
1. Mechanism of Action
2. Route
3. Uses (mark drug of choice: üü¢ DOC for [condition])
4. Combination Therapy
5. Adverse Effects (mark serious/toxic effects: ‚ö†Ô∏è hepatotoxicity, ‚ö†Ô∏è bone marrow suppression)
6. Contraindications
7. Drug Interactions
8. Pharmacokinetics
9. Special Considerations
10. [Other categories as found in source]

### Tab 2: Key Comparisons
- Sheet name: "Key Comparisons"
- Side-by-side comparisons ACROSS drug classes
- Categories: Mechanisms, Toxicities, Uses, Drug Interactions, DOC

**Specific Comparison Tables to Include:**
1. **Combined Drug Comparison Chart** (if applicable) - Shows combination drugs with components (Drug 1 + Drug 2 = Combined Name)
2. **Adverse Effects Comparison** - Side-by-side comparison of common adverse effects
3. **First-line vs Second-line Drugs** - Clear treatment hierarchy designation
4. **Toxicity Comparison** - Serious/life-threatening effects, overdose symptoms
5. **[Other comparisons as needed]** - Based on source content

**Format Rules:**
- Make multiple separate comparison tables, each with clear headers
- **Only compare 1 category at a time per table**
- **Group similar information together** (e.g., if Foscarnet and Acyclovir both cause renal toxicity, place rows near each other for easy memorization)
- Color-code each comparison table
- Use visual indicators for critical information

### Tab 3: Master Chart
- Sheet name: "Master Chart"
- ALL drugs in ONE comprehensive table
- Rows = individual drugs
- Frozen header row for scrolling
- Quick reference chart

**Column Order (left to right):**
1. Drug Class
2. Drug Name (Brand)
3. Mechanism of Action
4. Route
5. Uses (with üü¢ DOC notation)
6. Combination Therapy
7. Adverse Effects (with ‚ö†Ô∏è for toxicity)
8. Contraindications
9. Drug Interactions
10. Pharmacokinetics
11. Special Considerations
12. [Other categories as found in source]

### Tab 4 (Optional): FYI Drugs
- Sheet name: "FYI Drugs"
- **Only include if source has FYI/Future Reference sections**
- Simple 2-column table: Drug Name | Page Number
- Lists drugs marked as "FYI" or "Future reference material" in source
- These drugs are NOT counted in main drug inventory
- Format: Plain list, minimal styling

**When to include:**
- Source contains section labeled "FYI", "Future reference", or similar
- Drugs explicitly marked as supplementary/additional reference

**Format:**
- Column 1: Drug Name (with brand name in parentheses)
- Column 2: Page Number
- Header row: Standard blue (#4472C4) with white text
- Data rows: Simple white background or light pastel
- No complex styling needed

---

## DATA EXTRACTION REQUIREMENTS

### Critical Rule: Drug-Specific vs Class-Wide Information

**Correctly identify what applies to:**

**Class-wide (merge cells across all drugs):**
- "All NRTIs can cause lactic acidosis" ‚Üí Merged cell for entire class

**Drug-specific (individual cells):**
- "Tenofovir causes nephrotoxicity" ‚Üí ONLY Tenofovir cell
- "Abacavir requires HLA-B*5701 screening" ‚Üí ONLY Abacavir cell

**Verify each extraction:**
- If source says "Drug A and Drug B are first-line" ‚Üí ONLY those 2 get üü¢
- If source says "Drug C is safe in pregnancy" ‚Üí ONLY Drug C gets that note
- Don't assume - extract EXACTLY as stated

### For EACH Drug, Extract:

**1. Basic Information**
- Generic name
- Brand name (if provided)
- Drug class/subclass
- Route of administration

**2. Mechanism of Action**
- Class mechanism (if shared)
- Drug-specific mechanism
- Target receptors/enzymes

**3. Clinical Uses**
- Primary indications
- Secondary uses
- üü¢ Mark first-line ONLY if source explicitly states
- Off-label uses (if mentioned)

**4. Combination Therapies**
- Which drugs combine
- Combination product names
- Rationale (if provided)

**5. Adverse Effects**
- **Class-wide AE** (merge if all drugs share)
- **Drug-specific AE** (individual cells)
- ‚ö†Ô∏è Mark serious/life-threatening effects
- Black box warnings
- Dose-limiting toxicities

**6. Contraindications**
- Absolute contraindications
- üö´ Mark critical ones
- Pregnancy warnings (if specified)
- Disease states to avoid

**7. Drug Interactions**
- Major interactions
- CYP450 interactions
- Food/herb interactions

**8. Resistance** (if applicable)
- How resistance develops
- Cross-resistance patterns

**9. Special Considerations**
- Monitoring requirements
- Dosing adjustments
- ‚ùó Critical information (e.g., "Screen HLA-B*5701 BEFORE use")
- ‚úÖ Positive notes (e.g., "Safe in pregnancy")

---

## FORMATTING REQUIREMENTS

### Colors & Styling
- See `Excel_Color_Reference.txt` for complete specifications
- 3-shade COLOR_SETS system (header, main, row_label)
- Rotate by drug class using pastel palette
- Header row: Dark blue (#4472C4), white bold text
- Data rows: Rotate through 10 pastel colors by drug class
- All cells: White borders (#FFFFFF)

**‚Üí See Excel_Drug_Example.py lines 15-85 for exact COLOR_SETS and rotation logic**
- Font Specifications (see Excel_Drug_Example.py for exact implementation):
  - Drug Details tab data: Size 12
  - Key Comparisons tab data: Size 10
  - Master Chart tab data: Size 10
  - Headers: Size 12 (bold)
  - Drug class headers: Size 18 (bold)
  - Drug names row: Size 16 (bold)
  - Property labels: Size 14 (bold)

### Row Heights
- Header row: 25
- Data rows: Auto-expand to fit content (no over/under expansion)

### Column Widths
- Property names: 30
- Drug names: 25
- Long text (mechanism, uses, AE): 35-40

**‚Üí See Excel_Drug_Example.py for exact row heights and column widths per element**

### Borders
- Use white borders (#FFFFFF) - invisible, blends with pastels
- Creates clean, modern look
- Apply to ALL cells BEFORE merging (see merged cell section below)

**‚Üí See Excel_Drug_Example.py lines 87-94 for border definitions**

### CRITICAL: Merged Cell Border Behavior

When merging cells in openpyxl, only the top-left cell retains styling (borders, colors, etc.). Other cells become MergedCell objects and lose formatting.

**CORRECT PATTERN (always use):**
1. Apply styling (borders, colors, fonts) to ALL cells in range FIRST
2. THEN merge the cells

**Example:**
```python
# Step 1: Style ALL cells B, C, D
for col_idx in range(2, 5):  # Columns B, C, D
    cell = ws.cell(current_row, col_idx)
    apply_cell_style(cell, text=value if col_idx==2 else '', bg_color=color)

# Step 2: THEN merge
ws.merge_cells(start_row=current_row, start_column=2, end_row=current_row, end_column=4)
```

**See Excel_Drug_Example.py lines 292-300 for complete implementation**

### Text Formatting Within Cells
- Use bullet points (‚Ä¢) for lists
- Use line breaks (\n) for readability
- Bold critical warnings (but keep black color)
- UPPERCASE for emphasis (FATAL, NEVER, etc.)

---

## TAB 1: DRUG DETAILS STRUCTURE

### Pattern for Each Drug Class:

```
Row 1: [Merged] DRUG CLASS NAME (bold, header color, centered)
Row 2: Property | Drug 1 | Drug 2 | Drug 3 | Drug 4
Row 3: Mechanism | [Merged if same for all drugs in class]
Row 4: Route | [Merged if same]
Row 5: Uses | Individual (üü¢ DOC for [condition])
Row 6: Combination Therapy | Individual or merged
Row 7: Adverse Effects | [Merge if class-wide, separate if drug-specific] (‚ö†Ô∏è for toxicity)
Row 8: Contraindications | Individual
Row 9: Drug Interactions | Individual
Row 10: Pharmacokinetics | Individual or merged
Row 11: Special Considerations | Individual

[Space rows]

Next Drug Class...
```

---

## TAB 2: KEY COMPARISONS STRUCTURE

**Specific Comparison Tables to Include:**

1. **Combined Drug Comparison Chart** (if applicable)
   - Shows all combination drugs with their individual components
   - Format: Drug 1 + Drug 2 = Combined Name

2. **Adverse Effects Comparison**
   - Side-by-side comparison of common adverse effects across drug classes

3. **First-line vs Second-line Drugs**
   - Clear designation of treatment hierarchy

4. **Toxicity Comparison**
   - Serious/life-threatening effects
   - Overdose symptoms

5. **Mechanisms Comparison** (across classes)

6. **Drug Interactions Comparison**

7. **DOC (Drug of Choice) Comparison** by indication

8. **[Other comparisons as needed]** based on source content

### Format Rules:
- Make multiple separate comparison tables, each with clear headers
- **Only compare 1 category at a time per table**
- **Group similar information together**
  - Example: If Foscarnet and Acyclovir both cause renal toxicity, place these rows near each other for easy memorization
- Color-code each comparison table
- Use visual indicators for critical information

### Table Format:
```
Header Row: Category | Class/Drug 1 | Class/Drug 2 | Class/Drug 3 | Class/Drug 4
Row 1: Feature 1 | Value | Value | Value | Value
Row 2: Feature 2 | Value | Value | Value | Value
...
```

---

## TAB 3: MASTER CHART STRUCTURE

Single comprehensive table with ALL drugs:

**Column Order (left to right):**
1. Drug Class
2. Drug Name (Brand)
3. Mechanism of Action
4. Route
5. Uses (with üü¢ DOC notation)
6. Combination Therapy
7. Adverse Effects (with ‚ö†Ô∏è for toxicity)
8. Contraindications
9. Drug Interactions
10. Pharmacokinetics
11. Special Considerations
12. [Other categories as found in source]

```
Headers: Drug Class | Drug Name (Brand) | Mechanism | Route | Uses | Combination | Adverse Effects | Contraindications | Interactions | PK | Special

Row 1: Class A | Drug 1 | ... | ... | üü¢ DOC for HTN | ... | Nausea, ‚ö†Ô∏è hepatotoxicity | ... | ... | ... | ...
Row 2: Class A | Drug 2 | ... | ... | ... | ... | ... | ... | ... | ... | ...
Row 3: Class B | Drug 3 | ... | ... | ... | ... | ... | ... | ... | ... | ...
...
```

- Frozen header row (freeze panes at A2)
- Color-code rows by drug class
- All information condensed to one row per drug

---

## PYTHON IMPLEMENTATION

### Essential Helper Functions

Keep these in your script:

```python
from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill, Alignment, Border, Side

# See Excel_Color_Reference.txt for complete color definitions
HEADER_BG = '4472C4'
ROW_COLORS = ['D9E2F3', 'C8E6C9', 'D1C4E9', 'F7E7CE', 'BDD7EE',
              'F0F8FF', 'FCE4EC', 'EDE7F6', 'FFE8D6', 'BBDEFB']

def apply_cell_style(cell, text='', bold=False, font_size=10,
                     bg_color=None, alignment='left'):
    """Apply cell styling - see Excel_Drug_Example.py for full implementation"""
    cell.value = text
    cell.font = Font(name='Calibri', size=font_size, bold=bold, color='000000')
    cell.alignment = Alignment(horizontal=alignment, vertical='top', wrap_text=True)
    if bg_color:
        cell.fill = PatternFill(start_color=bg_color, end_color=bg_color, fill_type='solid')
    # White borders
    cell.border = Border(
        left=Side(style='thin', color='FFFFFF'),
        right=Side(style='thin', color='FFFFFF'),
        top=Side(style='thin', color='FFFFFF'),
        bottom=Side(style='thin', color='FFFFFF')
    )
```

### Complete Working Example

**For full 3-tab implementation, see:**
`Python_Examples/Excel_Drug_Example.py`

The example includes:
- Complete Tab 1 with drug class comparison tables (10 categories)
- Complete Tab 2 with key comparisons across classes (specific comparison tables)
- Complete Tab 3 with master chart of all drugs
- All helper functions and styling
- Row merging logic
- Color rotation by drug class
- DOC notation (üü¢) and toxicity marking (‚ö†Ô∏è) examples

---

## QUALITY CHECKLIST

Before finalizing:

### Content Accuracy
- [ ] ALL drugs from source included
- [ ] Drug-specific vs class-wide information correctly identified
- [ ] No information applied to wrong drug
- [ ] First-line designations ONLY where source explicitly states (üü¢ DOC for [condition])
- [ ] Toxicity marked with ‚ö†Ô∏è in Adverse Effects category

### Structure Compliance
- [ ] All 3 main tabs present with correct names (Drug Details, Key Comparisons, Master Chart)
- [ ] Tab 1: Comparison tables for each drug class (10 categories in order)
- [ ] Tab 1: Rows follow correct order (MOA, Route, Uses, Combination, AEs, Contraindications, Interactions, PK, Special)
- [ ] Tab 2: Specific comparison tables included (Combined Drug, AEs, First/Second-line, Toxicity, etc.)
- [ ] Tab 2: Only 1 category compared at a time per table
- [ ] Tab 2: Similar information grouped together
- [ ] Tab 3: Master chart with ALL drugs
- [ ] Tab 3: Columns in correct order
- [ ] Tab 4 (if applicable): FYI Drugs tab present if source has FYI section
- [ ] Tab 4 (if applicable): Simple 2-column format (Drug Name | Page Number)
- [ ] Tab 4 (if applicable): FYI drugs NOT included in main drug inventory count

### Formatting
- [ ] Colors match Excel_Color_Reference.txt
- [ ] Header row: Dark blue (#4472C4), white bold text
- [ ] Data rows: Pastel colors, black text
- [ ] White borders throughout
- [ ] Row heights fit content
- [ ] Frozen header on Tab 3
- [ ] üü¢ emoji used for DOC
- [ ] ‚ö†Ô∏è emoji used for serious/toxic effects

---

## COMMON MISTAKES TO AVOID

**DON'T:**
- ‚ùå Apply drug-specific info to entire class
- ‚ùå Mark drugs as "first-line" or "DOC" without source confirmation
- ‚ùå Use harsh colors instead of soft pastels
- ‚ùå Forget to freeze header row on Master Chart
- ‚ùå Add external medical knowledge
- ‚ùå Mix up category order (must follow the 10-category sequence)
- ‚ùå Forget to mark toxicity with ‚ö†Ô∏è emoji
- ‚ùå Forget to mark DOC with üü¢ emoji
- ‚ùå Include FYI drugs in main drug count or master chart
- ‚ùå Skip FYI tab when source has FYI section

**DO:**
- ‚úÖ Verify drug-specific vs class-wide information
- ‚úÖ Include page references in cells
- ‚úÖ Use soft pastel colors consistently
- ‚úÖ Follow the 10-category order for Tab 1 and Tab 3
- ‚úÖ Mark serious/toxic effects with ‚ö†Ô∏è in Adverse Effects
- ‚úÖ Mark drug of choice with üü¢ in Uses
- ‚úÖ Group similar information together in Tab 2 comparisons
- ‚úÖ Check for FYI/Future Reference sections in source
- ‚úÖ Create FYI Drugs tab if FYI drugs present
- ‚úÖ List FYI drugs separately from main drugs

---

## FILE SAVING

```python
wb.save('[Class]/[Exam]/Claude Study Tools/[Topic]_Drug_Chart.xlsx')
```

Example: `Pharmacology/Exam 3/Claude Study Tools/HIV_Drugs_Chart.xlsx`

---

**End of Instructions**

**For complete working code example:** `Python_Examples/Excel_Drug_Example.py`
**For color specifications:** `Excel_Color_Reference.txt`
