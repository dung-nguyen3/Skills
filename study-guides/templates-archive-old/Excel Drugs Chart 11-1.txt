# COMPREHENSIVE DRUG CHART EXCEL GENERATION INSTRUCTIONS


**You are a medical education specialist tasked with creating comprehensive, color-coded Excel drug charts from pharmacology content. Follow these instructions precisely:**

---

## BEFORE STARTING - VERIFICATION CHECKLIST

**STOP! Complete this verification BEFORE beginning any work:**

```
‚òê Which source file am I using? __________________________________
‚òê Which instruction template am I following? Comprehensive Drug Chart Instructions.txt
‚òê Am I using ONLY this source file (no external knowledge)? YES / NO
‚òê Exception: Mnemonics research allowed? YES
‚òê Where will I save output? [Class]/[Exam]/Claude Study Tools/
‚òê Have I read the ENTIRE source file? YES / NO
```

**Type out or state your answers to these questions before proceeding.**

---

## ‚ö†Ô∏è CRITICAL REQUIREMENTS ‚ö†Ô∏è

### BEFORE STARTING EVERY FILE - SAY THIS EXACTLY:
```
"I will ONLY use information from source files. Exception: Memory tricks/mnemonics will be researched."
```

‚ùå **SOURCE FILE ONLY**: Use ONLY information from the source file. **DO NOT ADD EXTERNAL KNOWLEDGE** (except for mnemonics).
   - If information is not in the source file, DO NOT include it
   - Copy medical terms EXACTLY as written in source
   - **NEVER ADD YOUR OWN INTERPRETATIONS OR EXPLANATIONS**
   - **NEVER ADD INFORMATION FROM YOUR TRAINING DATA**
   - **EXCEPTION:** If you believe information is VERY important/must-know that's not in source, include it BUT mark with asterisk (*) so user knows it's external knowledge. Try to minimize these additions.

‚úÖ **RESEARCH MNEMONICS**: Use web search to find established medical mnemonics and memory tricks. **NEVER INVENT NEW ONES**.
   - Search medical education websites
   - Use USMLE prep resources
   - Verify mnemonics from multiple sources
   - This is the ONLY exception to "source files only" rule

‚≠ê **SOFT PASTEL COLOR CHARTS**: ALL data cells must have soft pastel background colors
   - Header row: pastel color background
   - Data rows: pastel color background on ALL cells (not just first column)
   - Creates beautiful soft-colored tables throughout

‚ö†Ô∏è **EXACT COLOR SCHEME**: Follow the soft pastel color palette specified below - **DO NOT DEVIATE**

‚úÖ **COMPREHENSIVE COVERAGE**: Include **ALL** information from source file
   - Read the ENTIRE source file
   - Include every drug/condition mentioned (unless marked as FYI)
   - Don't skip minor topics

### üö® AFTER COMPLETING EVERY FILE - VERIFY AND SAY THIS EXACTLY:
```
"Verification complete: Only information from the source file was used. Exception: Memory tricks/mnemonics were researched."
```

### üö® AFTER VERIFICATION - ROW HEIGHT CHECK:
1. Re-analyze the generated Excel file
2. Check that ALL row heights are expanded just enough to show all content
3. DO NOT over-expand (wastes space) or under-expand (cuts off text)
4. Rows should fit content perfectly with minimal extra space

---

## FILE STRUCTURE: 4 TABS EXACTLY

### Tab 1: Drug Details
- Sheet name: "Drug Details"
- Drug class comparison tables
- Each drug class has its own table with drugs as columns
- Add "Analogy" box in column G near each separate chart made: Research and include 2-4 sentence analogy explanation for EACH drug's mechanism
- Example analogy: "Like cutting the assembly line belt" or "Acts like a bouncer blocking the door"
- Merged cells for properties shared across drugs in the class
- **MEMORY TRICKS & MNEMONICS ROW** after EACH drug class table

### Tab 2: Key Comparisons
- Sheet name: "Key Comparisons"
- Side-by-side comparisons across drug classes
- Categories: Mechanisms, Toxicities, Uses, Drug Interactions, etc.
- **CRITICAL:** Research good analogies - use web search for established medical education analogies

### Tab 3: Master Chart
- Sheet name: "Master Chart"
- ALL drugs in one comprehensive table
- Rows = individual drugs
- Columns = key characteristics
- Frozen header row for scrolling

### Tab 4: High-Yield & Pearls
- Sheet name: "High-Yield & Pearls"
- Clinical pearls
- Mnemonics
- "If X Think Y" associations
- Must-know facts

---

## SECTION 1: ANALYSIS PROCESS (DO THIS FIRST!)

### STEP 1: READ ENTIRE FILE
- Read the complete source file from beginning to end
- Note which drugs are mentioned
- Identify drug classes and how they're organized

### STEP 2: CREATE DRUG-SPECIFIC NOTES
For EACH drug, extract ONLY what the file says about THAT SPECIFIC drug:
- If file says "Tenofovir and Emtricitabine are first-line" ‚Üí ONLY those 2 get first-line designation
- If file says "Lamivudine is safe in pregnancy" ‚Üí ONLY Lamivudine gets this designation
- If file says "All NRTIs can cause lactic acidosis" ‚Üí ALL NRTIs get this in common AE
- If file says "Abacavir causes hypersensitivity" ‚Üí ONLY Abacavir gets this in specific AE

### STEP 3: VERIFY ACCURACY
- Double-check that you haven't applied information to the wrong drug
- Confirm first-line/preferred designations are only for drugs explicitly mentioned
- Make sure drug-specific adverse effects aren't listed for all drugs in the class

### STEP 4: RESEARCH MNEMONICS
**Use web_search to find established medical mnemonics**

Search Strategy:
```
"medical mnemonics [specific topic]"
"[drug class] mnemonic USMLE"
"[drug name] memory tricks medical students"
"how to remember [concept] pharmacology"
```

Examples:
- "alkylating agents mnemonic"
- "vinca alkaloid toxicity mnemonic"
- "antimetabolite drugs mnemonic"

‚ö†Ô∏è **CRITICAL**: Only use mnemonics found through research - **DO NOT INVENT NEW ONES**. ‚ùå

---

## SECTION 2: DATA EXTRACTION REQUIREMENTS

For EACH drug mentioned in the file, extract:

### 1. DRUG INFORMATION
- Drug name (generic)
- Brand name (if provided)
- Drug class/category
- Subclass if applicable

### 2. MECHANISM OF ACTION (MOA)
- Common MOA for the drug class (if all drugs share it)
- Specific MOA for individual drugs (if different from class)
- Primary mechanism
- Secondary mechanisms
- Unique features vs other drugs in class
- Target receptors/enzymes

### 3. CLINICAL USES/INDICATIONS
- Primary indications
- Secondary uses
- Off-label uses if mentioned
- First-line vs alternative therapy status
- **IMPORTANT:** Only mark as "first-line" if file explicitly states it for that specific drug

### 4. COMBINATION THERAPIES
- Which drugs are combined together
- What the combination is called (e.g., "Truvada")
- Do NOT repeat this information in the Uses row

### 5. ADVERSE EFFECTS (AE)
- Common adverse effects for the drug CLASS (merge cells if all drugs share them)
- Specific adverse effects for each INDIVIDUAL drug
- Serious/life-threatening effects
- Black box warnings
- Dose-limiting toxicities
- Organ-specific toxicities
- **CRITICAL:** Separate class-wide AE from drug-specific AE

### 6. CONTRAINDICATIONS
- Absolute contraindications
- Relative contraindications
- Pregnancy category/warnings (only if file specifies for that drug)
- Disease states to avoid
- Age restrictions

### 7. DRUG INTERACTIONS
- Major drug interactions
- Food interactions (e.g., grapefruit juice)
- Herb/supplement interactions
- CYP450 interactions
- Drugs that increase/decrease levels

### 8. RESISTANCE MECHANISMS (if applicable)
- How resistance develops
- Genetic factors
- Cross-resistance patterns

### 9. SPECIAL CONSIDERATIONS
- Monitoring requirements
- Dosing adjustments (renal/hepatic)
- Storage requirements
- Patient education points
- Screening requirements (genetic, labs)
- Precautions

### 10. PHARMACOKINETICS (if provided)
- Route of administration
- Absorption
- Distribution
- Metabolism
- Excretion
- Half-life

### 11. CLINICAL PEARLS
- Preferred drug status
- Drug of choice for specific conditions
- Rescue medications
- Antidotes

---

## SECTION 3: COLOR SCHEME - SOFT PASTELS WITH BLACK TEXT

### Soft Pastel Palette (EXACT HEX CODES):

```python
# Main colors for headers and backgrounds - LIGHT PASTEL COLORS
# Color Set 0: Ice Blue 40% (Accent 1) - Excel theme color
ICE_BLUE_HEADER = 'B4C6E7'  # Darker shade for headers
ICE_BLUE_MAIN = 'D9E2F3'    # Ice Blue 40% (Accent 1)
ICE_BLUE_ROW_LABEL = 'C5D3ED'  # Medium shade for row labels

# Color Set 1: Seafoam
SEAFOAM_HEADER = 'A8CCA8'
SEAFOAM_MAIN = 'C8E6C9'
SEAFOAM_ROW_LABEL = 'B8D9B9'

# Color Set 2: Light Orchid
LIGHT_ORCHID_HEADER = 'B8A4D0'
LIGHT_ORCHID_MAIN = 'D1C4E9'
LIGHT_ORCHID_ROW_LABEL = 'C4B4DC'

# Color Set 3: Champagne
CHAMPAGNE_HEADER = 'E0D0B0'
CHAMPAGNE_MAIN = 'F7E7CE'
CHAMPAGNE_ROW_LABEL = 'EBDBBF'

# Color Set 4: Sky Blue 60% (Accent 5) - Light Teal
SKY_BLUE_HEADER = '9DC3E6'
SKY_BLUE_MAIN = 'BDD7EE'  # Sky Blue 60% (Accent 5)
SKY_BLUE_ROW_LABEL = 'AECDEA'

# Color Set 5: Pale Azure
PALE_AZURE_HEADER = 'D0E8FF'
PALE_AZURE_MAIN = 'F0F8FF'
PALE_AZURE_ROW_LABEL = 'E0F0FF'

# Color Set 6: Blush Pink
BLUSH_PINK_HEADER = 'E8C4CC'
BLUSH_PINK_MAIN = 'FCE4EC'
BLUSH_PINK_ROW_LABEL = 'F2D4DC'

# Color Set 7: Soft Lilac
SOFT_LILAC_HEADER = 'D0C8DC'
SOFT_LILAC_MAIN = 'EDE7F6'
SOFT_LILAC_ROW_LABEL = 'DED7E9'

# Color Set 8: Soft Tangerine
SOFT_TANGERINE_HEADER = 'E0C8B0'
SOFT_TANGERINE_MAIN = 'FFE8D6'
SOFT_TANGERINE_ROW_LABEL = 'EFD8C3'

# Color Set 9: Powder Blue
POWDER_BLUE_HEADER = 'A0C4E8'
POWDER_BLUE_MAIN = 'BBDEFB'
POWDER_BLUE_ROW_LABEL = 'ADD1F1'

# Special boxes
MNEMONIC_BG = 'E6F3FF'  # Light blue for mnemonics
CLINICAL_PEARL_BG = 'E8F5E9'  # Light green for clinical pearls

# Main sheet title color
MAIN_TITLE_COLOR = '4472C4'  # Dark blue for main sheet titles
```

**TEXT FORMATTING:**
- ALL TEXT SHOULD BE BLACK (#000000) for maximum readability
- Class headers: Bold, Size 18
- Drug names: Bold, Size 16
- Row labels: Bold, Size 11
- Content: Regular, Size 14

**IMPORTANT:**
- Make sure header row is sized to the table chart. Do not extend it past the chart.
- Make sure to adjust each individual column and row to have the text shown.
- **ALL data cells must have soft pastel background colors** (not just first column)
- Header and Category column should be 1 shade darker. For example: If the chart is blue, make the header and category be 25% darker blue.

---

## SECTION 4: PYTHON SETUP CODE

### Required Imports and Basic Setup:
```python
from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill, Alignment, Border, Side
from openpyxl.utils import get_column_letter

# Create workbook
wb = Workbook()
wb.remove(wb.active)  # Remove default sheet

# Border style
thin_border = Border(
    left=Side(style='thin', color='FFFFFF'),
    right=Side(style='thin', color='FFFFFF'),
    top=Side(style='thin', color='FFFFFF'),
    bottom=Side(style='thin', color='FFFFFF')
)
```

### Helper Functions:

```python
def set_column_widths(ws, widths_dict):
    """Set column widths for a worksheet"""
    for col, width in widths_dict.items():
        ws.column_dimensions[col].width = width

def add_comparison_table(ws, start_row, title, headers, data, header_color, main_color):
    """
    Add a comparison table with title, headers, and data

    Args:
        ws: worksheet object
        start_row: starting row number
        title: table title (will be merged across columns)
        headers: list of column headers
        data: list of lists (rows of data)
        header_color: hex color for title row
        main_color: hex color for header row and data cells

    Returns:
        next available row number
    """
    current_row = start_row

    # Title row (merged across all columns)
    ws.merge_cells(f'A{current_row}:{get_column_letter(len(headers))}{current_row}')
    title_cell = ws[f'A{current_row}']
    title_cell.value = title
    title_cell.font = Font(bold=True, size=12, color='000000')
    title_cell.fill = PatternFill(start_color=header_color, end_color=header_color, fill_type='solid')
    title_cell.alignment = Alignment(horizontal='center', vertical='center')
    ws.row_dimensions[current_row].height = 25

    current_row += 1

    # Header row
    for col_idx, header in enumerate(headers, 1):
        cell = ws.cell(row=current_row, column=col_idx)
        cell.value = header
        cell.font = Font(bold=True, size=11, color='000000')
        cell.fill = PatternFill(start_color=main_color, end_color=main_color, fill_type='solid')
        cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
        cell.border = thin_border

    current_row += 1

    # Data rows
    for row_data in data:
        for col_idx, value in enumerate(row_data, 1):
            cell = ws.cell(row=current_row, column=col_idx)
            cell.value = value
            # First column is bold, ALL columns get pastel background
            if col_idx == 1:
                cell.font = Font(bold=True, size=10, color='000000')
            else:
                cell.font = Font(size=10, color='000000')
            # ‚≠ê ALL CELLS GET PASTEL BACKGROUND COLOR - NOT JUST FIRST COLUMN ‚≠ê
            cell.fill = PatternFill(start_color=main_color, end_color=main_color, fill_type='solid')
            cell.alignment = Alignment(wrap_text=True, vertical='top')
            cell.border = thin_border
        ws.row_dimensions[current_row].height = 50
        current_row += 1

    return current_row

def add_mnemonic_box(ws, start_row, end_col, content):
    """
    Add a mnemonic/memory tricks box

    Args:
        ws: worksheet object
        start_row: starting row number
        end_col: ending column letter
        content: mnemonic text content

    Returns:
        next available row number
    """
    ws.merge_cells(f'A{start_row}:{end_col}{start_row}')
    cell = ws[f'A{start_row}']
    cell.value = f'MEMORY TRICKS & MNEMONICS\n\n{content}'
    cell.alignment = Alignment(wrap_text=True, vertical='top', horizontal='left')
    cell.fill = PatternFill(start_color='E6F3FF', end_color='E6F3FF', fill_type='solid')
    cell.font = Font(size=11, color='000000')
    cell.border = thin_border
    ws.row_dimensions[start_row].height = 120
    return start_row + 1

def add_clinical_pearl_box(ws, start_row, end_col, content):
    """
    Add a clinical pearls box

    Args:
        ws: worksheet object
        start_row: starting row number
        end_col: ending column letter
        content: clinical pearl text content

    Returns:
        next available row number
    """
    ws.merge_cells(f'A{start_row}:{end_col}{start_row}')
    cell = ws[f'A{start_row}']
    cell.value = f'CLINICAL PEARLS\n\n{content}'
    cell.alignment = Alignment(wrap_text=True, vertical='top', horizontal='left')
    cell.fill = PatternFill(start_color='E8F5E9', end_color='E8F5E9', fill_type='solid')
    cell.font = Font(size=11, color='000000')
    cell.border = thin_border
    ws.row_dimensions[start_row].height = 80
    return start_row + 1
```

---

## SECTION 5: TAB 1 - DRUG DETAILS

### Sheet Structure:
- Sheet name: "Drug Details"
- Drug class comparison tables
- Each drug class has its own table with drugs as columns
- Merged cells for properties shared across drugs in the class

### Table Layout:
- Row 1: Merged cells with DRUG CLASS NAME (uppercase, bold), row height: 40, Font size: 18, Alignment: middle
- Row 2: Individual drug names as column headers, row height: 30, Font size: 16
- Column A: Row labels for each category
- Subsequent columns: Information for each drug

### REQUIRED rows (in this EXACT order):
1. Drug Class Header (Row 1)
2. Drug Names (Row 2)
3. Common MOA (if all drugs in class share same MOA - merge cells across all drug columns)
4. Specific MOA (if individual drugs have different/additional MOA - separate cells for each drug)
5. Uses (specific to each drug)
6. Combination Therapy (if stated in file): "Combined with [drug name]" or "Combined with [drug] ([combination name])"
   - **FORMATTING:** Combination drug names should be **underlined and bold**
   - **Do NOT repeat combination info in Uses row**
7. Drug Class Common AE (merged if applicable - only effects that apply to ALL drugs in class)
8. Specific Drug AE (individual cells - only effects specific to each drug, not already listed in common AE)
9. Contraindications
10. Resistance (if applicable)
11. Drug Interactions
12. Special Considerations
13. Pharmacokinetics (if significant)
14. Route

### FORMATTING RULES:
- If drugs have same MOA ‚Üí merge cells, put in "Common MOA" row
- If drugs have same MOA but 1 has additional detail ‚Üí merge "Common MOA", add "Specific MOA" row for the different one
- If drugs have same Uses/AE/Contraindications ‚Üí merge cells
- Keep answers straightforward: "Well tolerated" NOT "Generally well tolerated"
- For uses: "HIV" NOT "Used for HIV"
- **Common MOA must come AFTER drug names row**
- Separate drug classes with 2 empty rows

### MEMORY TRICKS & MNEMONICS ROW (REQUIRED):
- **AFTER each drug class table, add a row for memory tricks/mnemonics**
- Row format: Merge cells across all columns (A through last drug column)
- Background color: Light blue (#E6F3FF)
- Font: Size 11, black text
- Row height: 80-120px (adjust to fit content)
- Label: "MEMORY TRICKS & MNEMONICS"
- Content: Research and include established medical mnemonics for:
  - Drug names in the class
  - Mechanisms of action
  - Adverse effects
  - Uses/indications
  - Any other memorable patterns
- **CRITICAL:** Use web search to find ESTABLISHED mnemonics - NEVER invent new ones
- Include full breakdown/explanation of each mnemonic
- Leave 2 blank rows after mnemonic row before next drug class table

### Example Code for Tab 1:

```python
# ==================== TAB 1: DRUG DETAILS ====================
ws_details = wb.create_sheet('Drug Details', 0)  # First tab

# Set column widths
set_column_widths(ws_details, {'A': 25, 'B': 30, 'C': 30, 'D': 30, 'E': 30})

current_row = 1

# Sheet title
ws_details.merge_cells(f'A{current_row}:E{current_row}')
ws_details[f'A{current_row}'] = 'DRUG DETAILS - BY CLASS'
ws_details[f'A{current_row}'].font = Font(bold=True, size=16, color='FFFFFF')
ws_details[f'A{current_row}'].fill = PatternFill(start_color='4472C4', end_color='4472C4', fill_type='solid')
ws_details[f'A{current_row}'].alignment = Alignment(horizontal='center', vertical='center')
ws_details.row_dimensions[current_row].height = 30

current_row += 2

# Drug Class 1 Table
# ... (add drug class table using add_comparison_table or manual cells)

# After drug class table, add mnemonic row
current_row = add_mnemonic_box(ws_details, current_row, 'E', '[Researched mnemonic content]')

current_row += 2  # 2 blank rows before next drug class

# Continue for all drug classes...
```

---

## SECTION 6: VISUAL INDICATORS - MINIMAL EMOJI USE

**USE EMOJIS SPARINGLY - ONLY FOR THESE CRITICAL SITUATIONS:**

**üü¢ GREEN CIRCLE - Use for:**
- Drug of choice ONLY (only if file explicitly states)
- Format: "üü¢ DOC for [Condition Name]"
- Example: "üü¢ DOC for chronic myelogenous leukemia"

**‚ö†Ô∏è WARNING CIRCLE - Use for:**
- CRITICAL adverse effects (life-threatening, fatal, or severe toxicity)
- Black box warnings
- Fatal risks/reactions
- Examples: "‚ö†Ô∏è Fatal hemorrhagic cystitis", "‚ö†Ô∏è Cardiotoxicity", "‚ö†Ô∏è Permanent hearing loss"
- DO NOT use for minor or common adverse effects

**BOLD TEXT - Use for:**
- Key differences between similar drugs
- Important details that distinguish drugs
- Critical information in Drug Details and Master Chart sheets
- Examples: "**Low** myelosuppression" (when unique), "**First-line** for HIV", "**Only** NRTI safe in pregnancy"

---

## SECTION 7: CRITICAL INFORMATION TO HIGHLIGHT

**ALWAYS INCLUDE if mentioned:**
- "Drug of choice" or "first-line" (only for drugs explicitly stated) - use üü¢
- "Preferred over [other drug]" - use **bold**
- "Fatal" or "life-threatening" - use ‚ö†Ô∏è
- "Black box warning" - use ‚ö†Ô∏è
- "Do not use in pregnancy" or "Safe in pregnancy" - use **bold**
- "Screen for [test] before starting"
- "Monitor [parameter]"
- "Narrow therapeutic window"
- "No [toxicity]" (when unique to that drug) - use **bold**
- Specific drug combinations (double/triple therapy)
- Antidotes or rescue medications
- Percentage statistics (efficacy, adverse events)
- Time requirements ("within 72 hours", etc.)

**BOLD TEXT USAGE IN DRUG DETAILS & MASTER CHART:**
- Use **bold** to highlight KEY DIFFERENCES between similar drugs
- Use **bold** for IMPORTANT DETAILS that distinguish one drug from others
- Examples:
  - "**Only** drug in class safe in pregnancy"
  - "**Low** myelosuppression" (when other drugs have high)
  - "**First-line** for treatment"
  - "**No** bone marrow suppression" (when unique)
  - "**Requires** genetic testing"
  - "**Must** take with food"
  - "**Contraindicated** in pregnancy"

---

## SECTION 8: TAB 2 - KEY COMPARISONS

### Sheet Structure:
- Sheet name: "Key Comparisons"
- Create multiple separate comparison tables, each with clear headers
- Rows = items being compared
- Columns = comparison categories
- **REQUIRED for Mechanism comparisons: Add "Analogy" column/row** - Research and include 2-4 sentence analogy explanation for EACH drug's mechanism to help students understand how it works
- **CRITICAL:** Research good analogies - use web search for established medical education analogies

### Comparison Tables to Include:
1. **Combined Drug Comparison Chart** (if applicable): Shows all combination drugs with their individual components and combined drug names. Format: Drug 1 + Drug 2 = Combined Name
2. Adverse effects comparison
3. First-line vs second-line drugs
4. Pregnancy safety comparison
5. Drug interactions
6. Resistance patterns (if stated in files)
7. Toxicity profiles
8. Medical Condition/Virus treatment protocols
9. Route of administration
10. Pharmacokinetics comparison

### Format Rules:
- Make multiple separate comparison tables, each with clear headers
- Rows = items being compared
- Columns = comparison categories
- **For Key comparison sheet, only compare 1 category at a time**
- **If there are similar information, try to have them near each other**
  - Example: Foscarnet and acyclovir can cause renal toxicity, have these 2 rows near each other for easy memorization
- Color-code each comparison table
- Use visual indicators for critical information

### Example Code for Tab 2:

```python
# ==================== TAB 2: KEY COMPARISONS ====================
ws_comp = wb.create_sheet('Key Comparisons', 1)  # Second tab

set_column_widths(ws_comp, {'A': 25, 'B': 35, 'C': 35, 'D': 35, 'E': 35})

current_row = 1

# Sheet title
ws_comp.merge_cells(f'A{current_row}:E{current_row}')
ws_comp[f'A{current_row}'] = 'KEY COMPARISONS'
ws_comp[f'A{current_row}'].font = Font(bold=True, size=16, color='FFFFFF')
ws_comp[f'A{current_row}'].fill = PatternFill(start_color='4472C4', end_color='4472C4', fill_type='solid')
ws_comp[f'A{current_row}'].alignment = Alignment(horizontal='center', vertical='center')
ws_comp.row_dimensions[current_row].height = 30

current_row += 2

# Comparison 1: Mechanisms with Analogies
current_row = add_comparison_table(
    ws_comp, current_row,
    'COMPARISON: Mechanisms of Action',
    ['Drug Class', 'Mechanism', 'Analogy', 'Cell Cycle Specificity'],
    [
        ['Alkylating Agents', 'Alkylate DNA ‚Üí crosslinks', 'Like superglue binding DNA strands together', 'Non-specific'],
        ['Antimetabolites', 'Block nucleotide synthesis', 'Like removing building blocks from construction', 'S phase specific'],
        # ... more drugs with analogies
    ],
    LIGHT_BLUE_HEADER, LIGHT_BLUE_MAIN
)

current_row += 2

# Add mnemonic after relevant comparison
mnem = '[Researched mnemonic for mechanisms]'
current_row = add_mnemonic_box(ws_comp, current_row, 'E', mnem)

# Continue with more comparisons...
```

---

## SECTION 9: TAB 3 - MASTER CHART

### Sheet Structure:
- Sheet name: "Master Chart"
- ALL drugs from file in one comprehensive table
- ROWS = individual drugs
- COLUMNS = key characteristics
- Frozen header row for scrolling

### Columns:
Drug Class | Drug Name | Route | Mechanism | Uses | Adverse Effects | Contraindications | Resistance | Drug Interactions | Special Considerations | Notes

### Formatting:
- Color-code rows by drug class (use soft pastel colors)
- Header row: Dark blue background (#4472C4), white text, **FROZEN**
- First column: Drug names (bold, black text)
- Text wrapping: Enabled for all cells
- Row height: 60-80px (adjust to fit content)
- Include visual indicators for warnings, first-line drugs, etc.
- Only include information stated in the file

### Example Code for Tab 3:

```python
# ==================== TAB 3: MASTER CHART ====================
ws_master = wb.create_sheet('Master Chart', 2)  # Third tab

# Set column widths
column_widths = {'A': 20, 'B': 25, 'C': 12, 'D': 30, 'E': 30, 'F': 30, 'G': 25, 'H': 25, 'I': 30, 'J': 30, 'K': 25}
for col, width in column_widths.items():
    ws_master.column_dimensions[col].width = width

# Header row
headers = ['Drug Class', 'Drug Name', 'Route', 'Mechanism', 'Uses', 'Adverse Effects', 'Contraindications', 'Resistance', 'Drug Interactions', 'Special Considerations', 'Notes']
for col_idx, header in enumerate(headers, 1):
    cell = ws_master.cell(1, col_idx, header)
    cell.font = Font(bold=True, size=12, color='FFFFFF')
    cell.fill = PatternFill(start_color='4472C4', end_color='4472C4', fill_type='solid')
    cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
    cell.border = thin_border

# Freeze first row
ws_master.freeze_panes = 'A2'

# Data rows - ALL DRUGS (color-coded by drug class)
data_rows = [
    ['Alkylating Agent', 'Cyclophosphamide', 'IV', 'Alkylates DNA ‚Üí crosslinks', 'Cancer', '‚ö†Ô∏è Hemorrhagic cystitis', 'None absolute', 'None noted', 'None major', 'üíä MESNA for cystitis prevention', 'Also immunosuppressant'],
    # ... Continue for ALL drugs
]

# Add data with color coding by class
for row_idx, row_data in enumerate(data_rows, start=2):
    # Determine color based on drug class (first column)
    drug_class = row_data[0]
    # Assign color based on class...

    for col_idx, value in enumerate(row_data, 1):
        cell = ws_master.cell(row_idx, col_idx, value)
        cell.alignment = Alignment(wrap_text=True, vertical='top')
        cell.border = thin_border
        cell.font = Font(size=10, color='000000')
        # First column bold
        if col_idx == 1:
            cell.font = Font(bold=True, size=10, color='000000')
        # Color-code rows
        # cell.fill = PatternFill(start_color=class_color, end_color=class_color, fill_type='solid')
    ws_master.row_dimensions[row_idx].height = 60
```

---

## SECTION 10: TAB 4 - HIGH-YIELD & PEARLS

### Sheet Structure:
- Sheet name: "High-Yield & Pearls"
- Sections (each with merged cells A:C or wider):
  1. Treatment regimens (e.g., HAART, combination protocols)
  2. First-line drug recommendations
  3. Prophylaxis strategies
  4. "If X, Think Y" clinical associations
  5. Critical drug interactions
  6. Mnemonics and memory tricks (researched)
  7. Must-know facts
  8. Statistics and key numbers

### Section Headers:
- Section titles: Clinical Pearls, Mnemonics & Memory Tricks, If You See X Think Y, Must-Know Facts
- Color-code sections with different pastel backgrounds
- Font size 14, bold, black text on colored headers

### Example Code for Tab 4:

```python
# ==================== TAB 4: HIGH-YIELD & PEARLS ====================
ws_high = wb.create_sheet('High-Yield & Pearls', 3)  # Fourth tab

set_column_widths(ws_high, {'A': 50, 'B': 50, 'C': 50})

current_row = 1

# Sheet title
ws_high.merge_cells(f'A{current_row}:C{current_row}')
ws_high[f'A{current_row}'] = 'HIGH-YIELD & CLINICAL PEARLS'
ws_high[f'A{current_row}'].font = Font(bold=True, size=16, color='FFFFFF')
ws_high[f'A{current_row}'].fill = PatternFill(start_color='4472C4', end_color='4472C4', fill_type='solid')
ws_high[f'A{current_row}'].alignment = Alignment(horizontal='center', vertical='center')
ws_high.row_dimensions[current_row].height = 30

current_row += 2

# Section 1: Clinical Pearls
ws_high.merge_cells(f'A{current_row}:C{current_row}')
ws_high[f'A{current_row}'] = 'CLINICAL PEARLS'
ws_high[f'A{current_row}'].font = Font(bold=True, size=14, color='000000')
ws_high[f'A{current_row}'].fill = PatternFill(start_color=LIGHT_GREEN_HEADER, end_color=LIGHT_GREEN_HEADER, fill_type='solid')
ws_high[f'A{current_row}'].alignment = Alignment(horizontal='center', vertical='center')
ws_high.row_dimensions[current_row].height = 25

current_row += 1

pearls = """‚Ä¢ Pearl 1: [From source file]
‚Ä¢ Pearl 2: [From source file]
‚Ä¢ Pearl 3: [From source file]"""

ws_high.merge_cells(f'A{current_row}:C{current_row}')
ws_high[f'A{current_row}'].value = pearls
ws_high[f'A{current_row}'].alignment = Alignment(wrap_text=True, vertical='top')
ws_high[f'A{current_row}'].font = Font(size=11, color='000000')
ws_high[f'A{current_row}'].fill = PatternFill(start_color=CLINICAL_PEARL_BG, end_color=CLINICAL_PEARL_BG, fill_type='solid')
ws_high[f'A{current_row}'].border = thin_border
ws_high.row_dimensions[current_row].height = 100

current_row += 2

# Section 2: Mnemonics
ws_high.merge_cells(f'A{current_row}:C{current_row}')
ws_high[f'A{current_row}'] = 'MNEMONICS & MEMORY TRICKS'
ws_high[f'A{current_row}'].font = Font(bold=True, size=14, color='000000')
ws_high[f'A{current_row}'].fill = PatternFill(start_color=LIGHT_BLUE_HEADER, end_color=LIGHT_BLUE_HEADER, fill_type='solid')
ws_high[f'A{current_row}'].alignment = Alignment(horizontal='center', vertical='center')
ws_high.row_dimensions[current_row].height = 25

current_row += 1

mnemonics_text = """[Mnemonic 1: Topic]
[Letter] = [Meaning]

[Mnemonic 2: Topic]
[Letter] = [Meaning]"""

ws_high.merge_cells(f'A{current_row}:C{current_row}')
ws_high[f'A{current_row}'].value = mnemonics_text
ws_high[f'A{current_row}'].alignment = Alignment(wrap_text=True, vertical='top')
ws_high[f'A{current_row}'].font = Font(size=11, color='000000')
ws_high[f'A{current_row}'].fill = PatternFill(start_color=MNEMONIC_BG, end_color=MNEMONIC_BG, fill_type='solid')
ws_high[f'A{current_row}'].border = thin_border
ws_high.row_dimensions[current_row].height = 150

current_row += 2

# Section 3: "If You See X, Think Y"
ws_high.merge_cells(f'A{current_row}:C{current_row}')
ws_high[f'A{current_row}'] = 'IF YOU SEE X, THINK Y'
ws_high[f'A{current_row}'].font = Font(bold=True, size=14, color='000000')
ws_high[f'A{current_row}'].fill = PatternFill(start_color=LIGHT_PURPLE_HEADER, end_color=LIGHT_PURPLE_HEADER, fill_type='solid')
ws_high[f'A{current_row}'].alignment = Alignment(horizontal='center', vertical='center')
ws_high.row_dimensions[current_row].height = 25

current_row += 1

associations = """‚Ä¢ If you see: [Symptom/Finding] ‚Üí Think: [Drug/Diagnosis]
‚Ä¢ If you see: [Symptom/Finding] ‚Üí Think: [Drug/Diagnosis]"""

ws_high.merge_cells(f'A{current_row}:C{current_row}')
ws_high[f'A{current_row}'].value = associations
ws_high[f'A{current_row}'].alignment = Alignment(wrap_text=True, vertical='top')
ws_high[f'A{current_row}'].font = Font(size=11, color='000000')
ws_high.row_dimensions[current_row].height = 100

current_row += 2

# Section 4: Must-Know Facts
ws_high.merge_cells(f'A{current_row}:C{current_row}')
ws_high[f'A{current_row}'] = 'MUST-KNOW FACTS'
ws_high[f'A{current_row}'].font = Font(bold=True, size=14, color='000000')
ws_high[f'A{current_row}'].fill = PatternFill(start_color=LIGHT_TEAL_HEADER, end_color=LIGHT_TEAL_HEADER, fill_type='solid')
ws_high[f'A{current_row}'].alignment = Alignment(horizontal='center', vertical='center')
ws_high.row_dimensions[current_row].height = 25

current_row += 1

facts = """‚Ä¢ Fact 1: [From source]
‚Ä¢ Fact 2: [From source]
‚Ä¢ Fact 3: [From source]"""

ws_high.merge_cells(f'A{current_row}:C{current_row}')
ws_high[f'A{current_row}'].value = facts
ws_high[f'A{current_row}'].alignment = Alignment(wrap_text=True, vertical='top')
ws_high[f'A{current_row}'].font = Font(size=11, color='000000')
ws_high.row_dimensions[current_row].height = 100
```

---

## SECTION 11: ROW HEIGHT EXPANSION & SAVE WORKBOOK

### ‚ö†Ô∏è CRITICAL: Expand Row Heights to Fit Content Perfectly

```python
# ==================== EXPAND ROW HEIGHTS ====================
# This MUST be done AFTER all content is added
# Expand rows to fit content - NOT TOO MUCH, NOT TOO LITTLE

for sheet in wb.worksheets:
    for row in sheet.iter_rows():
        max_height = 15  # Minimum height
        for cell in row:
            if cell.value and isinstance(cell.value, str):
                # Count newlines
                lines = cell.value.count('\n') + 1

                # If wrap_text is enabled, estimate wrapped lines
                if cell.alignment and cell.alignment.wrap_text:
                    col_width = sheet.column_dimensions[cell.column_letter].width
                    if col_width:
                        # Estimate number of lines based on content length and column width
                        # Each character is approximately 1.2 units wide in default font
                        char_per_line = col_width * 0.9  # Slightly conservative
                        estimated_lines = max(lines, len(cell.value) / char_per_line)
                        max_height = max(max_height, estimated_lines * 15)

        # Set the row height (cap at 500 to prevent excessive heights)
        sheet.row_dimensions[row[0].row].height = min(max_height, 500)

# ==================== SAVE WORKBOOK ====================
output_path = '/path/to/output/[Drug Topic]_Drug_Chart.xlsx'
wb.save(output_path)
print(f"‚úÖ File saved: {output_path}")
print(f"\nSheets created:")
print(f"  1. Drug Details - Drug class comparison tables")
print(f"  2. Key Comparisons - Side-by-side comparisons")
print(f"  3. Master Chart - All drugs in one table")
print(f"  4. High-Yield & Pearls - Clinical pearls and mnemonics")
print(f"\n‚úì Row heights expanded to fit content")
```

---

## SECTION 12: SPECIAL FORMATTING RULES

### 1. DRUG NAMES:
- Generic name (Brand¬Æ)
- Bold, black text
- Add visual indicators to drug name if preferred/first-line

### 2. TEXT FORMATTING:
- Use bullet points (‚Ä¢) for lists
- Use line breaks (\n) for readability
- Bold critical warnings (but keep black color)
- UPPERCASE for emphasis (FATAL, NEVER, etc.)

### 3. ORGANIZATION:
- Group related information together
- Separate drug classes with 2 empty rows
- Keep consistent row order across all tables

### 4. ABBREVIATIONS:
- Define on first use
- Keep commonly used abbreviations (MOA, AE, etc.)

### 5. STRAIGHTFORWARD LANGUAGE:
- "Well tolerated" NOT "Generally well tolerated"
- "HIV" NOT "Used for HIV"
- Direct statements without hedging

### 6. CATEGORY PLACEMENT RULES:
- **Only include route in the route category**
- **Put information in the correct categories**
  - Example: Put "monitor renal function" in the special considerations category. Do NOT put it in the contraindication
- **Do NOT add additional information that was not from the source file**
  - Example: Do not add additional adverse effects if the file does not include it. Only add the adverse effects that the source file states for the drug
- **Do not include irrelevant categories such as "Why it matters", etc.**
- **If including mechanism class category, also include mechanism of action category**
- **For Adverse Effects, list toxicity effects first**

---

## SECTION 13: COMMON MISTAKES TO AVOID

**WRONG:** Marking all NRTIs as "first-line" when only specific ones are
**RIGHT:** Only mark drugs explicitly stated as first-line. Analyze source file thoroughly to make sure that the information is correct for each drug. Before merging cells, always verify that the information corresponds to each drug cell being merged. Only create common category/merged cells if they share the same exact information.

**WRONG:** Putting combination info in both "Uses" and "Combination Therapy" rows
**RIGHT:** Only in "Combination Therapy" row

**WRONG:** Assuming drug is safe in pregnancy because class generally is
**RIGHT:** Only mark if file explicitly states that the specific drug is safe

**WRONG:** Applying drug-specific adverse effects to all drugs in class
**RIGHT:** Separate common AE (merged) from specific AE (individual)

**WRONG:** Putting "Common MOA" before drug names
**RIGHT:** Drug class header ‚Üí Drug names ‚Üí Common MOA ‚Üí rest of info

**WRONG:** Using phrases like "Generally well tolerated" or "Used for HIV"
**RIGHT:** "Well tolerated" and "HIV"

**WRONG:** Adding information from external knowledge
**RIGHT:** Only use information explicitly stated in the source file

**WRONG:** Not verifying before merging cells
**RIGHT:** Before grouping items together (drugs, conditions, findings), VERIFY they share the same information. Do NOT group drug classes or drug names together that don't belong.

---

## SECTION 14: ACCURACY VERIFICATION CHECKLIST

### ‚úÖ Before Delivering File:

**File Structure:**
- [ ] ‚úÖ **EXACTLY 4 TABS** in this order:
  1. Drug Details
  2. Key Comparisons
  3. Master Chart
  4. High-Yield & Pearls
- [ ] ‚úÖ Tab names match exactly

**Content** (‚ùå CRITICAL):
- [ ] ‚úÖ **ALL** information from source files included
- [ ] ‚ùå **NO EXTERNAL INFORMATION ADDED** (except researched mnemonics)
- [ ] ‚úÖ Medical terminology matches source **EXACTLY**
- [ ] ‚úÖ All drugs included (except those marked FYI)
- [ ] ‚ùå **VERIFY: Did you read the ENTIRE source file?**
- [ ] üö® **STATED AT START**: "I will ONLY use information from source files. Exception: Memory tricks/mnemonics will be researched."
- [ ] üö® **STATED AT END**: "Verification complete: Only information from the source file was used. Exception: Memory tricks/mnemonics were researched."

**Drug-Specific Verification:**
- [ ] ‚úÖ Did I verify each drug's information is specific (not class-wide)?
- [ ] ‚úÖ Did I only mark drugs as "first-line" if explicitly stated?
- [ ] ‚úÖ Did I verify before merging cells for common properties?
- [ ] ‚úÖ Information is drug-specific (not wrongly applied to all drugs in class)
- [ ] ‚úÖ First-line designation only for drugs explicitly stated
- [ ] ‚úÖ Pregnancy information only for drugs explicitly mentioned

**Pastel Color Charts** (‚≠ê CRITICAL):
- [ ] ‚úÖ ALL data cells have pastel background colors (not just first column)
- [ ] ‚úÖ Headers have pastel background colors
- [ ] ‚úÖ Charts look soft and colorful throughout (not white with colored headers)

**Row Heights** (‚ö†Ô∏è IMPORTANT):
- [ ] ‚úÖ ALL row heights expanded to fit content
- [ ] ‚úÖ No content is cut off or hidden
- [ ] ‚úÖ No excessive white space (rows not over-expanded)
- [ ] ‚úÖ Row height algorithm applied AFTER all content added

**Mnemonics** (‚ö†Ô∏è IMPORTANT):
- [ ] ‚úÖ **ALL** mnemonics researched via web_search
- [ ] ‚úÖ Each mnemonic **VERIFIED** from medical education sources
- [ ] ‚úÖ **FULL BREAKDOWN** of each acronym/phrase provided
- [ ] ‚ùå **NO INVENTED MNEMONICS** - research only!
- [ ] ‚úÖ Mnemonic row present after EACH drug class table

**Tab 1: Drug Details**:
- [ ] ‚úÖ Drug class comparison tables
- [ ] ‚úÖ Drugs as columns, properties as rows
- [ ] ‚úÖ All drug classes included
- [ ] ‚úÖ Color rotation for each class
- [ ] ‚úÖ Common MOA placed AFTER drug names row
- [ ] ‚úÖ Combination therapy not duplicated in Uses row
- [ ] ‚úÖ Memory tricks row after each drug class
- [ ] ‚úÖ Mechanism comparisons include "Analogy" box in column E near each separate chart with researched analogies
- [ ] ‚úÖ 2 blank rows between drug classes

**Tab 2: Key Comparisons**:
- [ ] ‚úÖ Side-by-side comparison tables
- [ ] ‚úÖ Mnemonics placed below relevant comparisons
- [ ] ‚úÖ Multiple comparison categories included
- [ ] ‚úÖ Only 1 category compared at a time

**Tab 3: Master Chart**:
- [ ] ‚úÖ One row per drug
- [ ] ‚úÖ All relevant columns included
- [ ] ‚úÖ First row frozen
- [ ] ‚úÖ Text wrapping enabled

**Tab 4: High-Yield & Pearls**:
- [ ] ‚úÖ Clinical pearls section
- [ ] ‚úÖ Mnemonics section
- [ ] ‚úÖ "If X Think Y" associations
- [ ] ‚úÖ Must-know facts

**Formatting**:
- [ ] ‚úÖ Exact color scheme followed (hex codes)
- [ ] ‚úÖ ALL TEXT IS BLACK (#000000)
- [ ] ‚úÖ Column widths set appropriately
- [ ] ‚úÖ Row heights adjusted for wrapped text
- [ ] ‚úÖ Consistent fonts and styles
- [ ] ‚úÖ All cells have borders where appropriate
- [ ] ‚úÖ Text wrapping enabled for all content cells
- [ ] ‚úÖ Visual indicators (üü¢ and ‚ö†Ô∏è) used ONLY for DOC and critical toxicity
- [ ] ‚úÖ **Bold text** used for key differences and important details in Drug Details and Master Chart

**File Management**:
- [ ] ‚úÖ File saved to [Class]/[Exam]/Claude Study Tools/
- [ ] ‚úÖ File saved with descriptive name
- [ ] ‚úÖ File opens without errors

**Critical Review (DO THIS!):**
- [ ] ‚úÖ **REREAD** the source file section about each drug before finalizing its information
- [ ] ‚úÖ **REANALYZE** source file and excel file you created to make sure all important information from the source file are included
- [ ] ‚úÖ **VERIFY** that all information for each drug is accurate
- [ ] ‚úÖ **VERIFY** that only the source file was used (exception: researched mnemonics)

---

## SECTION 15: WORKFLOW SUMMARY

**STEP-BY-STEP PROCESS:**

1. **State verification checklist and source-only policy**
2. Read entire source file thoroughly
3. Create notes for each drug class
4. Extract drug-specific information for each individual drug
5. Research mnemonics via web search
6. Verify accuracy of each piece of information
7. Write Python code to generate Excel file
8. Run code to create file
9. Apply row height expansion algorithm
10. Verify file was created successfully
11. **State completion verification**
12. Deliver file with brief confirmation

**DO NOT skip the verification steps. Take time to ensure accuracy.**

---

## SECTION 16: FILE ORGANIZATION

**Save output files properly:**
- ‚úÖ Always save output files in the "Claude Study Tools" folder within the class directory
- üìÇ Example: If source is in Pharmacology/Exam 3/Extract/, save output in Pharmacology/Exam 3/Claude Study Tools/
- ‚úÖ Create "Claude Study Tools" folder if it doesn't exist
- ‚úÖ Keep all generated study materials (Excel, Word, etc.) in Claude Study Tools folder

---

## FINAL REMINDERS

**‚úÖ KEY PRINCIPLES:**
- ‚ùå **SOURCE FILE ONLY** - **NO EXTERNAL INFORMATION** (except researched mnemonics)
- ‚ö†Ô∏è **EXACTLY 4 TABS** in specified order
- ‚≠ê **SOFT PASTEL COLORS** on ALL data cells (not just first column)
- ‚ö†Ô∏è **EXACT COLOR SCHEME** - **DO NOT DEVIATE**
- ‚úÖ **COMPREHENSIVE COVERAGE** of **ALL** material
- ‚úÖ Research mnemonics via web search (verify from multiple sources)
- ‚úÖ Follow design specifications **EXACTLY**
- ‚úÖ Verify **ALL** information before delivery
- ‚úÖ ALL TEXT IS BLACK (#000000)

**DO NOT:**
- NEVER Add external medical knowledge (exception: mnemonics/memory tricks)
- Invent mnemonics
- Skip any drugs mentioned in source (unless marked FYI)
- Change color scheme
- Guess or assume information not in source
- Create more or less than 4 tabs
- Use white backgrounds for data cells
- Apply drug-specific information to all drugs in class
- Mark drugs as "first-line" unless explicitly stated

**CRITICAL - Review each drug individually:**
- Does this drug specifically have this MOA, or is it class-wide?
- Is this drug specifically mentioned as first-line, or just its class?
- Does this specific drug have this adverse effect, or is it class-wide?
- Is this drug specifically safe in pregnancy, or are you assuming?
- Does this drug have this contraindication, or just similar drugs?
- Is this drug specifically in this combination, or are you guessing?
- Did the file explicitly state this, or am I adding external knowledge?

---

**End of Instructions**
